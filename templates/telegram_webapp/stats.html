{% extends 'telegram_webapp/base.html' %}

{% block content %}
<div class="stats-intro">
    <p style="text-align: center; margin-bottom: 20px; color: var(--tg-theme-hint-color, #999999);">
        –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã ExamFlow üìä
    </p>
</div>

{% if error %}
<div class="error">
    {{ error }}
</div>
{% endif %}

<div class="stats-grid">
    <div class="stat-card" data-subjects-count="{{ subjects_count }}">
        <div class="stat-number">{{ subjects_count }}</div>
        <div class="stat-label">–ü—Ä–µ–¥–º–µ—Ç–æ–≤</div>
    </div>
    <div class="stat-card" data-tasks-count="{{ tasks_count }}">
        <div class="stat-number">{{ tasks_count }}</div>
        <div class="stat-label">–ó–∞–¥–∞–Ω–∏–π</div>
    </div>
</div>

<div class="stats-details" style="margin-top: 24px;">
    <h4 style="margin-bottom: 16px; color: var(--tg-theme-text-color, #000000);">
        üéØ –î–æ—Å—Ç—É–ø–Ω–æ —Å–µ–π—á–∞—Å:
    </h4>
    
    <div style="display: flex; flex-direction: column; gap: 12px;">
        <div class="stat-card" style="margin-bottom: 0;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                    <div style="font-size: 16px; font-weight: 500; margin-bottom: 4px;">
                        ü§ñ –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫
                    </div>
                    <div style="font-size: 12px; color: var(--tg-theme-hint-color, #999999);">
                        Gemini + DeepSeek
                    </div>
                </div>
                <div style="color: #4CAF50; font-weight: 600;">
                    ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
                </div>
            </div>
        </div>
        
        <div class="stat-card" style="margin-bottom: 0;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                    <div style="font-size: 16px; font-weight: 500; margin-bottom: 4px;">
                        üìö –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
                    </div>
                    <div style="font-size: 12px; color: var(--tg-theme-hint-color, #999999);">
                        üìê –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (–ø—Ä–æ—Ñ–∏–ª—å/–±–∞–∑–∞), üìù –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
                    </div>
                </div>
                <div style="color: #4CAF50; font-weight: 600;">
                    ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞
                </div>
            </div>
        </div>
        
        <div class="stat-card" style="margin-bottom: 0;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                    <div style="font-size: 16px; font-weight: 500; margin-bottom: 4px;">
                        üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
                    </div>
                    <div style="font-size: 12px; color: var(--tg-theme-hint-color, #999999);">
                        –ë–æ—Ç ‚Üî –í–µ–±-—Å–∞–π—Ç
                    </div>
                </div>
                <div style="color: #4CAF50; font-weight: 600;">
                    ‚úÖ –í–∫–ª—é—á–µ–Ω–∞
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
<div style="margin-top: 32px;">
    <h4 style="margin-bottom: 12px; color: var(--tg-theme-text-color, #000000);">
        ‚ö° –ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ:
    </h4>
    <div style="display: grid; gap: 8px;">
        <button class="btn btn-primary" onclick="goToAIChat()">
            ü§ñ –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ò–ò
        </button>
        <button class="btn btn-secondary" onclick="goToSubjects()">
            üìö –í—ã–±—Ä–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç
        </button>
    </div>
</div>

<!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ -->
<div style="margin-top: 24px;">
    <button class="btn btn-secondary" onclick="goHome()">
        ‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é
    </button>
</div>

<!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
<div style="margin-top: 32px; padding: 16px; background: var(--tg-theme-secondary-bg-color, #f8f8f8); border-radius: 12px;">
    <h4 style="margin-bottom: 12px; color: var(--tg-theme-text-color, #000000); text-align: center;">
        üì± ExamFlow 2025
    </h4>
    <p style="font-size: 14px; color: var(--tg-theme-hint-color, #999999); text-align: center; line-height: 1.4;">
        –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –ï–ì–≠ –∏ –û–ì–≠ —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º. 
        –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã.
    </p>
    <div style="text-align: center; margin-top: 12px;">
        <button class="btn btn-secondary" onclick="openWebsite()" style="font-size: 14px; padding: 8px 16px;">
            üåê –û—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç
        </button>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function openWebsite() {
    window.Telegram.WebApp.openLink('https://examflow.ru');
}

// –ê–Ω–∏–º–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
    const statNumbers = document.querySelectorAll('.stat-number');
    
    statNumbers.forEach(stat => {
        const finalValue = parseInt(stat.textContent);
        if (finalValue > 0) {
            let currentValue = 0;
            const increment = Math.ceil(finalValue / 20);
            const timer = setInterval(() => {
                currentValue += increment;
                if (currentValue >= finalValue) {
                    currentValue = finalValue;
                    clearInterval(timer);
                }
                stat.textContent = currentValue;
            }, 50);
        }
    });
});
</script>
{% endblock %}
