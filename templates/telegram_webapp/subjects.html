{% extends 'telegram_webapp/base.html' %}

{% block content %}
<div class="subjects-intro">
    <p style="text-align: center; margin-bottom: 20px; color: var(--tg-theme-hint-color, #999999);">
        –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è üìö
    </p>
</div>

<div class="subject-list">
    {% if subjects %}
        {% for subject in subjects %}
        <div class="subject-item" onclick="selectSubject('{{ subject.id }}', '{{ subject.name }}')">
            <div class="subject-name">
                {% if '—Ä—É—Å—Å–∫' in subject.name|lower or 'russian' in subject.code|lower %}üìù
                {% elif '–º–∞—Ç–µ–º–∞—Ç–∏–∫' in subject.name|lower or 'math' in subject.code|lower %}üìê
                {% else %}üìö
                {% endif %}
                {{ subject.name }}
            </div>
            <div class="subject-desc">
                {% if subject.description %}
                    {{ subject.description|truncatechars:80 }}
                {% else %}
                    –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ï–ì–≠ –∏ –û–ì–≠ –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É
                {% endif %}
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="error">
            üìö –ü—Ä–µ–¥–º–µ—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è...
        </div>
    {% endif %}
</div>

<!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ -->
<div style="margin-top: 32px;">
    <button class="btn btn-secondary" onclick="goHome()">
        ‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é
    </button>
</div>

<!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
<div style="margin-top: 24px;">
    <h4 style="margin-bottom: 12px; color: var(--tg-theme-text-color, #000000);">
        ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
    </h4>
    <div style="display: grid; gap: 8px;">
        <button class="btn btn-secondary" onclick="goToAIChat()">
            ü§ñ –°–ø—Ä–æ—Å–∏—Ç—å –ò–ò –æ –ª—é–±–æ–º –ø—Ä–µ–¥–º–µ—Ç–µ
        </button>
        <button class="btn btn-secondary" onclick="randomTask()">
            üé≤ –°–ª—É—á–∞–π–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ
        </button>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function selectSubject(subjectId, subjectName) {
    hapticFeedback();
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–µ–¥–º–µ—Ç–µ
    showAlert(`–í—ã–±—Ä–∞–Ω –ø—Ä–µ–¥–º–µ—Ç: ${subjectName}\n\n–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞. –ü–µ—Ä–µ–π—Ç–∏ –∫ —á–∞—Ç—É?`);
    
    // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –∑–∞–¥–∞–Ω–∏—è–º –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É
    setTimeout(() => {
        goToAIChat();
    }, 1500);
}

function randomTask() {
    hapticFeedback();
    showAlert('üé≤ –§—É–Ω–∫—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞!');
}

// –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
    const subjects = document.querySelectorAll('.subject-item');
    subjects.forEach((subject, index) => {
        subject.style.opacity = '0';
        subject.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            subject.style.transition = 'all 0.3s ease';
            subject.style.opacity = '1';
            subject.style.transform = 'translateY(0)';
        }, index * 100);
    });
});
</script>
{% endblock %}
