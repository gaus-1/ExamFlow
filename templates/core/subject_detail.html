{% extends 'base.html' %}
{% load static %}

{% block title %}{{ subject.name }} - {{ subject.exam_type }} - ExamFlow{% endblock %}

{% block content %}
<!-- Hero —Å–µ–∫—Ü–∏—è -->
<section class="hero-section section-padding animate-on-scroll" style="background: #fffef2;">
    <div class="container">
        <div class="text-center">
            <div class="text-8xl mb-6 rotate">
                {% if subject.name|lower|startswith:'–º–∞—Ç–µ–º–∞—Ç' %}üìê
                {% elif subject.name|lower|startswith:'—Ä—É—Å' %}üìù
                {% else %}üìö{% endif %}
            </div>
            <h1 class="text-4xl md:text-6xl font-bold mb-6 heading-animate" style="color: #252525;">
                {{ subject.name }}
            </h1>
            <p class="text-xl md:text-2xl mb-8 text-reveal" style="color: #666;">
                {{ subject.exam_type }} - {{ total_tasks }} –∑–∞–¥–∞–Ω–∏–π –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏
            </p>
            <a href="https://t.me/ExamFlowBot" target="_blank" 
               class="btn-primary btn-animate text-lg px-8 py-4">
                üì± –ù–∞—á–∞—Ç—å –≤ Telegram –±–æ—Ç–µ
            </a>
        </div>
    </div>
</section>

<!-- –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞ -->
<section class="section-padding animate-on-scroll" style="background: #f8f8f8;">
    <div class="container">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-3xl md:text-4xl font-bold mb-8 heading-animate" style="color: #252525;">
                –û –ø—Ä–µ–¥–º–µ—Ç–µ
            </h2>
            <div class="text-lg text-reveal" style="color: #666;">
                {% if subject.name|lower|startswith:'–º–∞—Ç–µ–º–∞—Ç' %}
                    <p class="mb-4">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞: –∞–ª–≥–µ–±—Ä–∞, –≥–µ–æ–º–µ—Ç—Ä–∏—è, —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Ç–µ–æ—Ä–∏—è —á–∏—Å–µ–ª.</p>
                    <p>–ï–ì–≠ (–ø—Ä–æ—Ñ–∏–ª—å/–±–∞–∑–∞) –∏ –û–ì–≠ ‚Äî –∑–∞–¥–∞–Ω–∏—è —Å —Ä–µ—à–µ–Ω–∏—è–º–∏ –∏ —Ä–∞–∑–±–æ—Ä–æ–º.</p>
                {% elif subject.name|lower|startswith:'—Ä—É—Å' %}
                    <p class="mb-4">–†—É—Å—Å–∫–∏–π —è–∑—ã–∫: –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è, –ø—É–Ω–∫—Ç—É–∞—Ü–∏—è, –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞, –ª–µ–∫—Å–∏–∫–∞, —Å–æ—á–∏–Ω–µ–Ω–∏–µ.</p>
                    <p>–ï–ì–≠ –∏ –û–ì–≠ ‚Äî –∫—Ä–∏—Ç–µ—Ä–∏–∏, —à–∞–±–ª–æ–Ω—ã –∏ –ø—Ä–∏–º–µ—Ä—ã —Å –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏.</p>
                {% else %}
                    <p class="mb-4">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ {{ subject.exam_type }} –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É {{ subject.name }}.</p>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- –ó–∞–¥–∞–Ω–∏—è -->
<section class="section-padding animate-on-scroll" style="background: #fffef2;">
    <div class="container">
        <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl font-bold mb-4 heading-animate" style="color: #252525;">
                –ó–∞–¥–∞–Ω–∏—è –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏
            </h2>
            <p class="text-lg text-reveal" style="color: #666;">
                {{ total_tasks }} –∑–∞–¥–∞–Ω–∏–π —Ä–∞–∑–ª–∏—á–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            </p>
        </div>
        
        {% if page_obj %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12 cards-grid">
            {% for task in page_obj %}
            <div class="task-item bg-white rounded-2xl p-6 shadow-lg card-hover text-reveal animate-on-scroll" 
                 data-difficulty="{{ task.difficulty }}">
                <div class="mb-4">
                    <span class="inline-block px-3 py-1 rounded-full text-sm font-medium
                        {% if task.difficulty == 1 %}bg-green-100 text-green-800
                        {% elif task.difficulty == 2 %}bg-yellow-100 text-yellow-800
                        {% else %}bg-red-100 text-red-800{% endif %}">
                        –°–ª–æ–∂–Ω–æ—Å—Ç—å: {{ task.difficulty }}
                    </span>
                </div>
                
                <h3 class="text-xl font-bold mb-3 task-title" style="color: #252525;">
                    {{ task.title }}
                </h3>
                
                <p class="text-gray-600 mb-4">
                    {{ task.description|truncatewords:20 }}
                </p>
                
                <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500">
                        {{ task.created_at|date:"d.m.Y" }}
                    </span>
                    <a href="{% url 'task_detail' task.id %}" 
                       class="btn-secondary btn-animate">
                        –†–µ—à–∏—Ç—å
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
        {% if page_obj.has_other_pages %}
        <div class="flex justify-center items-center space-x-2">
            {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}" 
               class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">
                ‚Üê –ù–∞–∑–∞–¥
            </a>
            {% endif %}
            
            <span class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg">
                –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}
            </span>
            
            {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}" 
               class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">
                –í–ø–µ—Ä–µ–¥ ‚Üí
            </a>
            {% endif %}
        </div>
        {% endif %}
        
        {% else %}
        <div class="text-center">
            <div class="text-6xl mb-4">üìù</div>
            <h3 class="text-2xl font-bold mb-4" style="color: #252525;">
                –ó–∞–¥–∞–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è...
            </h3>
            <p class="text-gray-600">
                –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ, –ø–æ–∫–∞ –º—ã –∑–∞–≥—Ä—É–∑–∏–º –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ —ç—Ç–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É.
            </p>
        </div>
        {% endif %}
    </div>
</section>

<!-- CTA —Å–µ–∫—Ü–∏—è -->
<section class="section-padding animate-on-scroll" style="background: #f8f8f8;">
    <div class="container">
        <div class="text-center">
            <h2 class="text-3xl md:text-4xl font-bold mb-6 heading-animate" style="color: #252525;">
                –ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É?
            </h2>
            <p class="text-xl mb-8 text-reveal" style="color: #666;">
                –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –≤ Telegram-–±–æ—Ç –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="https://t.me/ExamFlowBot" target="_blank" 
                   class="btn-primary btn-animate text-lg px-8 py-4">
                    üì± –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞
                </a>
                <a href="{% url 'subject_list' %}" 
                   class="btn-secondary btn-animate text-lg px-8 py-4">
                    üìö –í—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}